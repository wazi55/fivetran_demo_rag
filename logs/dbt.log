[0m14:10:50.036062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7635c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a780eb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a780ea710>]}


============================== 14:10:50.042483 | 35cc9b34-9a4f-426b-86bf-c03133f5a0d6 ==============================
[0m14:10:50.042483 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:10:50.043251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:18.385425 [debug] [MainThread]: Starter project path: /usr/local/anaconda3/lib/python3.10/site-packages/dbt/include/starter_project
[0m14:11:24.116882 [info ] [MainThread]: 
Your new dbt project "rag_pre_transform" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:11:24.117700 [debug] [MainThread]: Command `dbt init` succeeded at 14:11:24.117558 after 34.12 seconds
[0m14:11:24.118045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7635c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a76685990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a76687280>]}
[0m14:11:24.118412 [debug] [MainThread]: Flushing usage events
[0m13:48:00.710095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc549589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc567e7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc567e5240>]}


============================== 13:48:00.716972 | e090aa99-c490-42c8-be49-59276c516bfd ==============================
[0m13:48:00.716972 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:48:00.717745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:48:00.801219 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "rag_pre_transform", target "dev" invalid: ['dbname'] is not of type 'string'
[0m13:48:00.802137 [debug] [MainThread]: Command `dbt compile` failed at 13:48:00.801967 after 0.13 seconds
[0m13:48:00.802565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc549589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc567da800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc567da530>]}
[0m13:48:00.803099 [debug] [MainThread]: Flushing usage events
[0m13:49:40.493361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79cb649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79def7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79def4fd0>]}


============================== 13:49:40.498415 | 1e88a608-159a-4892-b2b0-8fd4e211f744 ==============================
[0m13:49:40.498415 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:49:40.499178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:49:40.552843 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "rag_pre_transform", target "dev" invalid: ['dbname'] is not of type 'string'
[0m13:49:40.553738 [debug] [MainThread]: Command `dbt run` failed at 13:49:40.553578 after 0.09 seconds
[0m13:49:40.554142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79cb649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79dee5c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79dee74f0>]}
[0m13:49:40.554662 [debug] [MainThread]: Flushing usage events
[0m13:53:21.366717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6aa549d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6d0e3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6d0e1180>]}


============================== 13:53:21.373784 | 92b0040a-9cb6-40ae-ae0c-d616fb20c74f ==============================
[0m13:53:21.373784 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:53:21.374641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:53:21.381976 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m13:53:21.382780 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "rag_pre_transform", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!
[0m13:53:21.383722 [debug] [MainThread]: Command `dbt test` failed at 13:53:21.383532 after 0.06 seconds
[0m13:53:21.384190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6aa549d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6d0cefe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6d0cd660>]}
[0m13:53:21.384756 [debug] [MainThread]: Flushing usage events
[0m13:53:57.228786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b0b6c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b1fffdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b1fff8b0>]}


============================== 13:53:57.234167 | be284132-b770-4d0f-9b2d-ab83556159ee ==============================
[0m13:53:57.234167 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:53:57.234918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:53:57.241794 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m13:53:57.242542 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "rag_pre_transform", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!
[0m13:53:57.243469 [debug] [MainThread]: Command `dbt list` failed at 13:53:57.243295 after 0.05 seconds
[0m13:53:57.243916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b0b6c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b1fe8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b1fe97b0>]}
[0m13:53:57.244382 [debug] [MainThread]: Flushing usage events
[0m13:54:34.124191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff478b609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47a0ef9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47a0ed180>]}


============================== 13:54:34.129353 | 5611ff78-1284-4e87-b783-fbe71f95e048 ==============================
[0m13:54:34.129353 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:54:34.130114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:54:34.137366 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m13:54:34.137998 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "rag_pre_transform", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!
[0m13:54:34.138928 [debug] [MainThread]: Command `dbt run` failed at 13:54:34.138730 after 0.04 seconds
[0m13:54:34.139408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff478b609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47a0d9120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47a0d8d90>]}
[0m13:54:34.139869 [debug] [MainThread]: Flushing usage events
[0m13:54:38.421705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b6a509d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b7fdfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b7fdcfa0>]}


============================== 13:54:38.427129 | 74da6b90-a9c1-4a34-b320-db42030e9167 ==============================
[0m13:54:38.427129 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:54:38.427865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/wazi/.dbt', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:54:38.435225 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m13:54:38.435880 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "rag_pre_transform", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!
[0m13:54:38.436758 [debug] [MainThread]: Command `dbt build` failed at 13:54:38.436588 after 0.04 seconds
[0m13:54:38.437190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b6a509d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b7fc9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b7fc91e0>]}
[0m13:54:38.437733 [debug] [MainThread]: Flushing usage events
[0m13:54:43.415286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e7835c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e79eeba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e79ee9120>]}


============================== 13:54:43.420297 | 04654b8a-2573-49db-8b13-d9777b5bb16a ==============================
[0m13:54:43.420297 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:54:43.421116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:54:43.421755 [info ] [MainThread]: Setting up your profile.
[0m13:54:53.063876 [error] [MainThread]: Encountered an error:

[0m13:54:53.068196 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/anaconda3/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/anaconda3/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/anaconda3/lib/python3.10/site-packages/dbt/cli/main.py", line 459, in init
    results = task.run()
  File "/usr/local/anaconda3/lib/python3.10/site-packages/dbt/task/init.py", line 276, in run
    adapter = self.ask_for_adapter_choice()
  File "/usr/local/anaconda3/lib/python3.10/site-packages/dbt/task/init.py", line 230, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
  File "/usr/local/anaconda3/lib/python3.10/site-packages/click/termui.py", line 166, in prompt
    value = prompt_func(prompt)
  File "/usr/local/anaconda3/lib/python3.10/site-packages/click/termui.py", line 149, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m13:54:53.069485 [debug] [MainThread]: Command `dbt init` failed at 13:54:53.069288 after 9.68 seconds
[0m13:54:53.069945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e7835c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e79eebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e79eebcd0>]}
[0m13:54:53.070578 [debug] [MainThread]: Flushing usage events
[0m13:56:15.375190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1cd4609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1cf7ed4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1cf7ec340>]}


============================== 13:56:15.381669 | e9ce011f-a85f-4bb3-92a0-d9a2a527db73 ==============================
[0m13:56:15.381669 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:56:15.382435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:56:15.383063 [info ] [MainThread]: Setting up your profile.
[0m13:57:34.128962 [info ] [MainThread]: Profile rag_pre_transform written to /Users/wazi/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:57:34.130712 [debug] [MainThread]: Command `dbt init` succeeded at 13:57:34.130198 after 78.80 seconds
[0m13:57:34.131210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1cd4609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1cf7eef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1cf7ed4e0>]}
[0m13:57:34.131714 [debug] [MainThread]: Flushing usage events
[0m13:57:41.077621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89512609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89528efb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89528ee8f0>]}


============================== 13:57:41.083761 | 074d3d78-3bf5-45cc-b4e1-5e28c46c72b5 ==============================
[0m13:57:41.083761 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:57:41.084481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:43.125765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89528eea70>]}
[0m13:57:43.142835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956bf13c0>]}
[0m13:57:43.144087 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m13:57:43.176655 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:57:43.178190 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:57:43.178843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956bf2170>]}
[0m13:57:44.078051 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m13:57:44.157828 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.rag_pre_transform.example
[0m13:57:44.164214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956d97310>]}
[0m13:57:44.173381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956bf0dc0>]}
[0m13:57:44.173985 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:57:44.174473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956d16c50>]}
[0m13:57:44.176001 [info ] [MainThread]: 
[0m13:57:44.177061 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:57:44.178316 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m13:57:44.178813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:46.148336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m13:57:46.149685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:46.452372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89528ef970>]}
[0m13:57:46.453662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:46.454292 [info ] [MainThread]: 
[0m13:57:46.463586 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m13:57:46.464310 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m13:57:46.465199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m13:57:46.465682 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m13:57:46.468713 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m13:57:46.470207 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 13:57:46.466008 => 13:57:46.469878
[0m13:57:46.470677 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m13:57:46.513328 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m13:57:46.514606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:46.515170 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as WITH stg AS (
       SELECT CONCAT('This winery name is ', IFNULL(WINERY_OR_VINEYARD, ' Name is not known')
        , '. California wine region: ', IFNULL(CA_WINE_REGION, 'unknown'), ''
        , ' The AVA Appellation is the ', IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'), '.'
        , ' The website associated with the winery is ', IFNULL(WEBSITE, 'unknown'), '.'
        , ' Price Range: ', IFNULL(PRICE_RANGE, 'unknown'), '.'
        , ' Tasting Room Hours: ', IFNULL(TASTING_ROOM_HOURS, 'unknown'), '.'
        , ' Are Reservations Required or Not: ', IFNULL(RESERVATION_REQUIRED, 'unknown'), '.'
        , ' Winery Description: ', IFNULL(WINERY_DESCRIPTION, 'unknown'), ''
        , ' The Primary Varietals this winery offers: ', IFNULL(PRIMARY_VARIETALS, 'unknown'), '.'
        , ' Thoughts on the Tasting Room Experience: ', IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'), '.'
        , ' Amenities: ', IFNULL(AMENITIES, 'unknown'), '.'
        , ' Awards and Accolades: ', IFNULL(AWARDS_AND_ACCOLADES, 'unknown'), '.'
        , ' Distance Travel Time considerations: ', IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'), '.'
        , ' User Rating: ', IFNULL(USER_RATING, 'unknown'), '.'
        , ' The Secondary Varietals for this winery: ', IFNULL(SECONDARY_VARIETALS, 'unknown'), '.'
        , ' Wine Styles: ', IFNULL(WINE_STYLES, 'unknown'), '.'
        , ' Events and Activities: ', IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'), '.'
        , ' Sustainability Practices: ', IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'), '.'
        , ' Social Media Channels: ', IFNULL(SOCIAL_MEDIA, 'unknown'), ''
        , ' Address: ', IFNULL(ADDRESS, 'unknown'), ''
        , ' City: ', IFNULL(CITY, 'unknown'), ''
        , ' State: ', IFNULL(STATE, 'unknown'), ''
        , ' ZIP: ', IFNULL(ZIP, 'unknown'), ''
        , ' Phone: ', IFNULL(PHONE, 'unknown'), ''
        , ' Winemaker: ', IFNULL(WINEMAKER, 'unknown'), ''
        , ' Did Kelly Kohlleffel recommend this winery?: ', IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'), ''
    ) AS winery_information FROM california_wine_country_visits;
)


            SELECT winery_information, 
            snowflake.cortex.embed_text('e5-base-v2', winery_information) as WINERY_EMBEDDING 
            FROM stg;;


[0m13:57:46.851301 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [33:64]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [33:64]')
[0m13:57:47.914349 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:464c831d-7219-4962-b867-24e2cadc3852&page=queryresults
[0m13:57:47.915459 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 13:57:46.471053 => 13:57:47.915045
[0m13:57:47.929141 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Expected ")" but got ";" at [33:64]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m13:57:47.929830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '074d3d78-3bf5-45cc-b4e1-5e28c46c72b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956d495a0>]}
[0m13:57:47.930681 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 1.46s]
[0m13:57:47.931472 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m13:57:47.933575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:47.933953 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m13:57:47.934337 [info ] [MainThread]: 
[0m13:57:47.934816 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m13:57:47.935507 [debug] [MainThread]: Command end result
[0m13:57:47.945891 [info ] [MainThread]: 
[0m13:57:47.946705 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:47.947817 [info ] [MainThread]: 
[0m13:57:47.948348 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m13:57:47.949030 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [33:64]
[0m13:57:47.949627 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m13:57:47.950083 [info ] [MainThread]: 
[0m13:57:47.950710 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:57:47.952020 [debug] [MainThread]: Command `dbt run` failed at 13:57:47.951852 after 6.92 seconds
[0m13:57:47.952778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89512609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956c45ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8956bf13c0>]}
[0m13:57:47.953483 [debug] [MainThread]: Flushing usage events
[0m13:59:03.861377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9395c609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396ff1600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396ff0370>]}


============================== 13:59:03.866989 | 241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be ==============================
[0m13:59:03.866989 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:59:03.867847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'profiles_dir': '/Users/wazi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:59:06.008078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396ff29e0>]}
[0m13:59:06.022581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939b3ed360>]}
[0m13:59:06.023559 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m13:59:06.050207 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:59:06.114290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:06.114893 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m13:59:06.138016 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m13:59:06.156382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.rag_pre_transform.example
[0m13:59:06.162118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939b5ee110>]}
[0m13:59:06.170150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939b56d8d0>]}
[0m13:59:06.170732 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:59:06.171268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939b56d810>]}
[0m13:59:06.173047 [info ] [MainThread]: 
[0m13:59:06.173929 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:59:06.175090 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m13:59:06.175586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:07.643686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m13:59:07.645060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:07.943532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939b557f40>]}
[0m13:59:07.948286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:07.950655 [info ] [MainThread]: 
[0m13:59:08.066841 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m13:59:08.067862 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m13:59:08.069163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m13:59:08.069824 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m13:59:08.072786 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m13:59:08.074040 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 13:59:08.070249 => 13:59:08.073662
[0m13:59:08.074670 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m13:59:08.122143 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m13:59:08.123491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:08.124521 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as WITH stg AS (
       SELECT CONCAT('This winery name is ', IFNULL(WINERY_OR_VINEYARD, ' Name is not known')
        , '. California wine region: ', IFNULL(CA_WINE_REGION, 'unknown'), ''
        , ' The AVA Appellation is the ', IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'), '.'
        , ' The website associated with the winery is ', IFNULL(WEBSITE, 'unknown'), '.'
        , ' Price Range: ', IFNULL(PRICE_RANGE, 'unknown'), '.'
        , ' Tasting Room Hours: ', IFNULL(TASTING_ROOM_HOURS, 'unknown'), '.'
        , ' Are Reservations Required or Not: ', IFNULL(RESERVATION_REQUIRED, 'unknown'), '.'
        , ' Winery Description: ', IFNULL(WINERY_DESCRIPTION, 'unknown'), ''
        , ' The Primary Varietals this winery offers: ', IFNULL(PRIMARY_VARIETALS, 'unknown'), '.'
        , ' Thoughts on the Tasting Room Experience: ', IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'), '.'
        , ' Amenities: ', IFNULL(AMENITIES, 'unknown'), '.'
        , ' Awards and Accolades: ', IFNULL(AWARDS_AND_ACCOLADES, 'unknown'), '.'
        , ' Distance Travel Time considerations: ', IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'), '.'
        , ' User Rating: ', IFNULL(USER_RATING, 'unknown'), '.'
        , ' The Secondary Varietals for this winery: ', IFNULL(SECONDARY_VARIETALS, 'unknown'), '.'
        , ' Wine Styles: ', IFNULL(WINE_STYLES, 'unknown'), '.'
        , ' Events and Activities: ', IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'), '.'
        , ' Sustainability Practices: ', IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'), '.'
        , ' Social Media Channels: ', IFNULL(SOCIAL_MEDIA, 'unknown'), ''
        , ' Address: ', IFNULL(ADDRESS, 'unknown'), ''
        , ' City: ', IFNULL(CITY, 'unknown'), ''
        , ' State: ', IFNULL(STATE, 'unknown'), ''
        , ' ZIP: ', IFNULL(ZIP, 'unknown'), ''
        , ' Phone: ', IFNULL(PHONE, 'unknown'), ''
        , ' Winemaker: ', IFNULL(WINEMAKER, 'unknown'), ''
        , ' Did Kelly Kohlleffel recommend this winery?: ', IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'), ''
    ) AS winery_information FROM california_wine_country_visits
)


            SELECT winery_information, 
            snowflake.cortex.embed_text('e5-base-v2', winery_information) as WINERY_EMBEDDING 
            FROM stg;;


[0m13:59:08.410004 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [39:22]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [39:22]')
[0m13:59:09.067922 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:bc3e3b69-0ca7-4826-a40c-ccc4aa7859e8&page=queryresults
[0m13:59:09.069013 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 13:59:08.075055 => 13:59:09.068688
[0m13:59:09.083934 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Unexpected ";" at [39:22]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m13:59:09.084605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '241fa8ee-2c6a-4aa9-b92f-b2e5ed2446be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9395e487c0>]}
[0m13:59:09.085398 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 1.02s]
[0m13:59:09.086070 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m13:59:09.088103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:09.088506 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m13:59:09.088898 [info ] [MainThread]: 
[0m13:59:09.089378 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m13:59:09.090089 [debug] [MainThread]: Command end result
[0m13:59:09.099155 [info ] [MainThread]: 
[0m13:59:09.099751 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:59:09.100208 [info ] [MainThread]: 
[0m13:59:09.100764 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m13:59:09.101205 [error] [MainThread]:   Syntax error: Unexpected ";" at [39:22]
[0m13:59:09.101757 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m13:59:09.102219 [info ] [MainThread]: 
[0m13:59:09.102695 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:59:09.103531 [debug] [MainThread]: Command `dbt run` failed at 13:59:09.103382 after 5.28 seconds
[0m13:59:09.104010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9395c609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939b3251e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9390995690>]}
[0m13:59:09.104540 [debug] [MainThread]: Flushing usage events
[0m14:00:15.376726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6cc709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6e123be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6e122950>]}


============================== 14:00:15.382613 | b618aed6-8d43-4457-9c86-5c1af5918826 ==============================
[0m14:00:15.382613 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:00:15.383431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/wazi/.dbt', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:00:17.600603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b618aed6-8d43-4457-9c86-5c1af5918826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6e122ad0>]}
[0m14:00:17.617343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b618aed6-8d43-4457-9c86-5c1af5918826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a724273a0>]}
[0m14:00:17.618874 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:00:17.650134 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:17.718878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:17.719599 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m14:00:17.751413 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:00:17.775597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.rag_pre_transform.example
[0m14:00:17.782347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b618aed6-8d43-4457-9c86-5c1af5918826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7273e140>]}
[0m14:00:17.792445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b618aed6-8d43-4457-9c86-5c1af5918826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a726a5900>]}
[0m14:00:17.793161 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:00:17.793669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b618aed6-8d43-4457-9c86-5c1af5918826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a726a5840>]}
[0m14:00:17.795594 [info ] [MainThread]: 
[0m14:00:17.796651 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:00:17.798010 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:00:17.798557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:19.193884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:00:19.194755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:19.532532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b618aed6-8d43-4457-9c86-5c1af5918826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7268feb0>]}
[0m14:00:19.534000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:19.534708 [info ] [MainThread]: 
[0m14:00:19.634680 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:19.635709 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:00:19.636726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:00:19.637255 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:19.639801 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:00:19.640915 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:00:19.637576 => 14:00:19.640580
[0m14:00:19.641403 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:19.683358 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:00:19.684436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:19.685044 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as WITH stg AS (
       SELECT CONCAT('This winery name is ', IFNULL(WINERY_OR_VINEYARD, ' Name is not known')
        , '. California wine region: ', IFNULL(CA_WINE_REGION, 'unknown'), ''
        , ' The AVA Appellation is the ', IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'), '.'
        , ' The website associated with the winery is ', IFNULL(WEBSITE, 'unknown'), '.'
        , ' Price Range: ', IFNULL(PRICE_RANGE, 'unknown'), '.'
        , ' Tasting Room Hours: ', IFNULL(TASTING_ROOM_HOURS, 'unknown'), '.'
        , ' Are Reservations Required or Not: ', IFNULL(RESERVATION_REQUIRED, 'unknown'), '.'
        , ' Winery Description: ', IFNULL(WINERY_DESCRIPTION, 'unknown'), ''
        , ' The Primary Varietals this winery offers: ', IFNULL(PRIMARY_VARIETALS, 'unknown'), '.'
        , ' Thoughts on the Tasting Room Experience: ', IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'), '.'
        , ' Amenities: ', IFNULL(AMENITIES, 'unknown'), '.'
        , ' Awards and Accolades: ', IFNULL(AWARDS_AND_ACCOLADES, 'unknown'), '.'
        , ' Distance Travel Time considerations: ', IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'), '.'
        , ' User Rating: ', IFNULL(USER_RATING, 'unknown'), '.'
        , ' The Secondary Varietals for this winery: ', IFNULL(SECONDARY_VARIETALS, 'unknown'), '.'
        , ' Wine Styles: ', IFNULL(WINE_STYLES, 'unknown'), '.'
        , ' Events and Activities: ', IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'), '.'
        , ' Sustainability Practices: ', IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'), '.'
        , ' Social Media Channels: ', IFNULL(SOCIAL_MEDIA, 'unknown'), ''
        , ' Address: ', IFNULL(ADDRESS, 'unknown'), ''
        , ' City: ', IFNULL(CITY, 'unknown'), ''
        , ' State: ', IFNULL(STATE, 'unknown'), ''
        , ' ZIP: ', IFNULL(ZIP, 'unknown'), ''
        , ' Phone: ', IFNULL(PHONE, 'unknown'), ''
        , ' Winemaker: ', IFNULL(WINEMAKER, 'unknown'), ''
        , ' Did Kelly Kohlleffel recommend this winery?: ', IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'), ''
    ) AS winery_information FROM `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
)


            SELECT winery_information, 
            -- snowflake.cortex.embed_text('e5-base-v2', winery_information) as WINERY_EMBEDDING 
            FROM stg;;


[0m14:00:20.003006 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [39:22]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [39:22]')
[0m14:00:20.774935 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:e761018d-489a-4cd1-8468-e45d113824bf&page=queryresults
[0m14:00:20.775917 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:00:19.641760 => 14:00:20.775616
[0m14:00:20.789397 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Unexpected ";" at [39:22]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:00:20.790134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b618aed6-8d43-4457-9c86-5c1af5918826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a71d38040>]}
[0m14:00:20.791014 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 1.15s]
[0m14:00:20.791676 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:20.793810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:20.794213 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:00:20.794587 [info ] [MainThread]: 
[0m14:00:20.795209 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m14:00:20.795934 [debug] [MainThread]: Command end result
[0m14:00:20.804444 [info ] [MainThread]: 
[0m14:00:20.805011 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:00:20.805466 [info ] [MainThread]: 
[0m14:00:20.805910 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m14:00:20.806361 [error] [MainThread]:   Syntax error: Unexpected ";" at [39:22]
[0m14:00:20.806788 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:00:20.807223 [info ] [MainThread]: 
[0m14:00:20.807687 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:00:20.808507 [debug] [MainThread]: Command `dbt run` failed at 14:00:20.808361 after 5.47 seconds
[0m14:00:20.808986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6cc709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7235d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a64f955a0>]}
[0m14:00:20.809495 [debug] [MainThread]: Flushing usage events
[0m14:00:34.918177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef883709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef896fd600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef896fc370>]}


============================== 14:00:34.924228 | 88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99 ==============================
[0m14:00:34.924228 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:00:34.925079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'profiles_dir': '/Users/wazi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:00:37.078435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef896fe9e0>]}
[0m14:00:37.095290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8daf9360>]}
[0m14:00:37.096787 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:00:37.127617 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:37.197859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:37.198541 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m14:00:37.228510 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:00:37.250277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.rag_pre_transform.example
[0m14:00:37.256424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8deee110>]}
[0m14:00:37.264749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8de6d8d0>]}
[0m14:00:37.265379 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:00:37.265867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8de6d810>]}
[0m14:00:37.267738 [info ] [MainThread]: 
[0m14:00:37.268711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:00:37.270176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:00:37.270710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:38.798046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:00:38.799025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:39.102580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8de57f40>]}
[0m14:00:39.103784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:39.104328 [info ] [MainThread]: 
[0m14:00:39.205326 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:39.206243 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:00:39.207296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:00:39.207851 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:39.210453 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:00:39.211548 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:00:39.208228 => 14:00:39.211202
[0m14:00:39.212053 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:39.254862 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:00:39.255965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:39.256589 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as WITH stg AS (
       SELECT CONCAT('This winery name is ', IFNULL(WINERY_OR_VINEYARD, ' Name is not known')
        , '. California wine region: ', IFNULL(CA_WINE_REGION, 'unknown'), ''
        , ' The AVA Appellation is the ', IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'), '.'
        , ' The website associated with the winery is ', IFNULL(WEBSITE, 'unknown'), '.'
        , ' Price Range: ', IFNULL(PRICE_RANGE, 'unknown'), '.'
        , ' Tasting Room Hours: ', IFNULL(TASTING_ROOM_HOURS, 'unknown'), '.'
        , ' Are Reservations Required or Not: ', IFNULL(RESERVATION_REQUIRED, 'unknown'), '.'
        , ' Winery Description: ', IFNULL(WINERY_DESCRIPTION, 'unknown'), ''
        , ' The Primary Varietals this winery offers: ', IFNULL(PRIMARY_VARIETALS, 'unknown'), '.'
        , ' Thoughts on the Tasting Room Experience: ', IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'), '.'
        , ' Amenities: ', IFNULL(AMENITIES, 'unknown'), '.'
        , ' Awards and Accolades: ', IFNULL(AWARDS_AND_ACCOLADES, 'unknown'), '.'
        , ' Distance Travel Time considerations: ', IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'), '.'
        , ' User Rating: ', IFNULL(USER_RATING, 'unknown'), '.'
        , ' The Secondary Varietals for this winery: ', IFNULL(SECONDARY_VARIETALS, 'unknown'), '.'
        , ' Wine Styles: ', IFNULL(WINE_STYLES, 'unknown'), '.'
        , ' Events and Activities: ', IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'), '.'
        , ' Sustainability Practices: ', IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'), '.'
        , ' Social Media Channels: ', IFNULL(SOCIAL_MEDIA, 'unknown'), ''
        , ' Address: ', IFNULL(ADDRESS, 'unknown'), ''
        , ' City: ', IFNULL(CITY, 'unknown'), ''
        , ' State: ', IFNULL(STATE, 'unknown'), ''
        , ' ZIP: ', IFNULL(ZIP, 'unknown'), ''
        , ' Phone: ', IFNULL(PHONE, 'unknown'), ''
        , ' Winemaker: ', IFNULL(WINEMAKER, 'unknown'), ''
        , ' Did Kelly Kohlleffel recommend this winery?: ', IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'), ''
    ) AS winery_information FROM `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
)


            SELECT winery_information
            -- snowflake.cortex.embed_text('e5-base-v2', winery_information) as WINERY_EMBEDDING 
            FROM stg;


[0m14:00:40.448989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:47335e12-796a-40f1-8618-755bd56dc06a&page=queryresults
[0m14:00:40.468020 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:00:39.212380 => 14:00:40.467583
[0m14:00:40.469159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ddfbaa-62f5-48d8-aeb1-0534f9ba9c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef896ea7d0>]}
[0m14:00:40.469921 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m14:00:40.470769 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:00:40.472751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:40.473113 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:00:40.473485 [info ] [MainThread]: 
[0m14:00:40.473944 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m14:00:40.474930 [debug] [MainThread]: Command end result
[0m14:00:40.483277 [info ] [MainThread]: 
[0m14:00:40.483829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:40.484266 [info ] [MainThread]: 
[0m14:00:40.484823 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:40.485647 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:40.485499 after 5.61 seconds
[0m14:00:40.486120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef883709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8cb68ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8da312a0>]}
[0m14:00:40.486599 [debug] [MainThread]: Flushing usage events
[0m14:26:07.857830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faa35c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faceefb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faceee770>]}


============================== 14:26:07.864884 | d6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd ==============================
[0m14:26:07.864884 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:26:07.865623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:26:10.218454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faceed420>]}
[0m14:26:10.233234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb1213550>]}
[0m14:26:10.234264 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:26:10.264857 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:26:10.278302 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:26:10.279111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb11ccf40>]}
[0m14:26:11.164452 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:26:11.222854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb12fab90>]}
[0m14:26:11.224853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faa546950>]}
[0m14:26:11.225469 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:26:11.225947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb153fd00>]}
[0m14:26:11.227372 [info ] [MainThread]: 
[0m14:26:11.228210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:26:11.229308 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719_fivetran_demo_rag_agriculture'
[0m14:26:11.229817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:13.418370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d0cf2e-8f87-4c3e-b771-b4fb17bf37fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb12897b0>]}
[0m14:26:13.419849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:26:13.420506 [info ] [MainThread]: 
[0m14:26:13.429300 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:26:13.430331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:26:13.430863 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:26:13.433857 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:26:13.434952 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:26:13.431197 => 14:26:13.434618
[0m14:26:13.435442 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:26:13.436063 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:26:13.435751 => 14:26:13.435785
[0m14:26:13.437349 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:26:13.438772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:13.439158 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:26:13.439974 [debug] [MainThread]: Command end result
[0m14:26:13.452323 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m14:26:13.452774 [info ] [MainThread]: Building catalog
[0m14:26:13.453471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:14.168746 [debug] [ThreadPool]: Acquiring new bigquery connection 'iamtests-315719.information_schema'
[0m14:26:14.189947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:14.190928 [debug] [ThreadPool]: On iamtests-315719.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "connection_name": "iamtests-315719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `iamtests-315719`.`fivetran_demo_rag_agriculture`.__TABLES__
        where (upper(dataset_id) = upper('fivetran_demo_rag_agriculture'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `iamtests-315719`.`fivetran_demo_rag_agriculture`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `iamtests-315719`.`fivetran_demo_rag_agriculture`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `iamtests-315719`.`fivetran_demo_rag_agriculture`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m14:26:17.369102 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:85bb35ea-f9d0-4a6f-8369-6125bcaf53f4&page=queryresults
[0m14:26:17.416431 [info ] [MainThread]: Catalog written to /Users/wazi/Downloads/fivetran_demo_rag/target/catalog.json
[0m14:26:17.417514 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:26:17.417347 after 9.60 seconds
[0m14:26:17.417893 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:26:17.418191 [debug] [MainThread]: Connection 'iamtests-315719.information_schema' was properly closed.
[0m14:26:17.418635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faa35c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faa545bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb126c400>]}
[0m14:26:17.419104 [debug] [MainThread]: Flushing usage events
[0m14:38:39.606475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b3c589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b57ebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b57ea890>]}


============================== 14:38:39.613973 | f770b0d0-25f5-452e-b7fc-c84398822d4c ==============================
[0m14:38:39.613973 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:38:39.615240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:38:42.331379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f770b0d0-25f5-452e-b7fc-c84398822d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b57eaa10>]}
[0m14:38:42.348410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f770b0d0-25f5-452e-b7fc-c84398822d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b99dc670>]}
[0m14:38:42.350020 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:38:42.380117 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:38:42.453466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:38:42.454154 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m14:38:42.482881 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:38:42.512793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f770b0d0-25f5-452e-b7fc-c84398822d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b9bedf30>]}
[0m14:38:42.522611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f770b0d0-25f5-452e-b7fc-c84398822d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b9b596f0>]}
[0m14:38:42.523333 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:38:42.523880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f770b0d0-25f5-452e-b7fc-c84398822d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b9b59630>]}
[0m14:38:42.525655 [info ] [MainThread]: 
[0m14:38:42.526579 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:38:42.527845 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:38:42.528358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:44.112076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:38:44.112928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:44.424811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f770b0d0-25f5-452e-b7fc-c84398822d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b57eb910>]}
[0m14:38:44.426029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:38:44.426621 [info ] [MainThread]: 
[0m14:38:44.556388 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:38:44.558623 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:38:44.561268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:38:44.562455 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:38:44.570806 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:38:44.572931 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:38:44.563136 => 14:38:44.572451
[0m14:38:44.573608 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:38:44.638151 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:38:44.640665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:44.641550 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as with (SELECT CONCAT('This winery name is ', IFNULL(WINERY_OR_VINEYARD, ' Name is not known')
, '. California wine region: ', IFNULL(CA_WINE_REGION, 'unknown'), ''
, ' The AVA Appellation is the ', IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'), '.'
, ' The website associated with the winery is ', IFNULL(WEBSITE, 'unknown'), '.'
, ' Price Range: ', IFNULL(PRICE_RANGE, 'unknown'), '.'
, ' Tasting Room Hours: ', IFNULL(TASTING_ROOM_HOURS, 'unknown'), '.'
, ' Are Reservations Required or Not: ', IFNULL(RESERVATION_REQUIRED, 'unknown'), '.'
, ' Winery Description: ', IFNULL(WINERY_DESCRIPTION, 'unknown'), ''
, ' The Primary Varietals this winery offers: ', IFNULL(PRIMARY_VARIETALS, 'unknown'), '.'
, ' Thoughts on the Tasting Room Experience: ', IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'), '.'
, ' Amenities: ', IFNULL(AMENITIES, 'unknown'), '.'
, ' Awards and Accolades: ', IFNULL(AWARDS_AND_ACCOLADES, 'unknown'), '.'
, ' Distance Travel Time considerations: ', IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'), '.'
, ' User Rating: ', IFNULL(USER_RATING, 'unknown'), '.'
, ' The Secondary Varietals for this winery: ', IFNULL(SECONDARY_VARIETALS, 'unknown'), '.'
, ' Wine Styles: ', IFNULL(WINE_STYLES, 'unknown'), '.'
, ' Events and Activities: ', IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'), '.'
, ' Sustainability Practices: ', IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'), '.'
, ' Social Media Channels: ', IFNULL(SOCIAL_MEDIA, 'unknown'), ''
, ' Address: ', IFNULL(ADDRESS, 'unknown'), ''
, ' City: ', IFNULL(CITY, 'unknown'), ''
, ' State: ', IFNULL(STATE, 'unknown'), ''
, ' ZIP: ', IFNULL(ZIP, 'unknown'), ''
, ' Phone: ', IFNULL(PHONE, 'unknown'), ''
, ' Winemaker: ', IFNULL(WINEMAKER, 'unknown'), ''
, ' Did Kelly Kohlleffel recommend this winery?: ', IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'), ''
) AS winery_information FROM `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
) as stg


      SELECT *
      FROM
        ML.GENERATE_TEXT_EMBEDDING(
          MODEL `project_beyondsql_genai_textembedding.llm_embedding_model`,
          (
            select winery_information as content from iamtests-315719.ragdemo.single_string_winery_review_vector
          ),
          STRUCT(TRUE AS flatten_json_output)
        );


[0m14:38:44.904153 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [6:11]; reason: invalidQuery, location: query, message: Syntax error: Unexpected "(" at [6:11]')
[0m14:38:45.508974 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:2d4ea9a9-4ca3-4814-8841-b22d2a8d7b62&page=queryresults
[0m14:38:45.510332 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:38:44.574012 => 14:38:45.509756
[0m14:38:45.525572 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Unexpected "(" at [6:11]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:38:45.526214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f770b0d0-25f5-452e-b7fc-c84398822d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b3e42950>]}
[0m14:38:45.527318 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 0.97s]
[0m14:38:45.527986 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:38:45.530449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:45.530839 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:38:45.531232 [info ] [MainThread]: 
[0m14:38:45.531712 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m14:38:45.532510 [debug] [MainThread]: Command end result
[0m14:38:45.541351 [info ] [MainThread]: 
[0m14:38:45.541957 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:38:45.542412 [info ] [MainThread]: 
[0m14:38:45.542859 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m14:38:45.543561 [error] [MainThread]:   Syntax error: Unexpected "(" at [6:11]
[0m14:38:45.544012 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:38:45.544463 [info ] [MainThread]: 
[0m14:38:45.545184 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:38:45.546035 [debug] [MainThread]: Command `dbt run` failed at 14:38:45.545882 after 5.99 seconds
[0m14:38:45.546516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b3c589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b9915240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b57d27a0>]}
[0m14:38:45.546998 [debug] [MainThread]: Flushing usage events
[0m14:39:28.851282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89af2d49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b0823b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b08228f0>]}


============================== 14:39:28.859103 | e60dcd81-1016-4350-9ffe-c461800fd2e8 ==============================
[0m14:39:28.859103 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:39:28.860125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:39:31.098554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e60dcd81-1016-4350-9ffe-c461800fd2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b0822a70>]}
[0m14:39:31.116481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e60dcd81-1016-4350-9ffe-c461800fd2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b4c146a0>]}
[0m14:39:31.117807 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:39:31.150477 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:39:31.224159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:31.224914 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m14:39:31.259186 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:39:31.289572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e60dcd81-1016-4350-9ffe-c461800fd2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b4f39f60>]}
[0m14:39:31.298905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e60dcd81-1016-4350-9ffe-c461800fd2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b4e91720>]}
[0m14:39:31.299615 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:39:31.300205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e60dcd81-1016-4350-9ffe-c461800fd2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b4e91660>]}
[0m14:39:31.302283 [info ] [MainThread]: 
[0m14:39:31.303691 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:39:31.305385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:39:31.306167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:32.721770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:39:32.722849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:33.028918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e60dcd81-1016-4350-9ffe-c461800fd2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b4ec08e0>]}
[0m14:39:33.030346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:33.031032 [info ] [MainThread]: 
[0m14:39:33.145754 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:39:33.146794 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:39:33.148036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:39:33.148670 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:39:33.151648 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:39:33.153205 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:39:33.149073 => 14:39:33.152493
[0m14:39:33.153871 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:39:33.201437 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:39:33.202701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:33.203892 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as with st as  (
    SELECT
        CONCAT(
            'This winery name is ',
            IFNULL(WINERY_OR_VINEYARD, ' Name is not known'),
            '. California wine region: ',
            IFNULL(CA_WINE_REGION, 'unknown'),
            '',
            ' The AVA Appellation is the ',
            IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'),
            '.',
            ' The website associated with the winery is ',
            IFNULL(WEBSITE, 'unknown'),
            '.',
            ' Price Range: ',
            IFNULL(PRICE_RANGE, 'unknown'),
            '.',
            ' Tasting Room Hours: ',
            IFNULL(TASTING_ROOM_HOURS, 'unknown'),
            '.',
            ' Are Reservations Required or Not: ',
            IFNULL(RESERVATION_REQUIRED, 'unknown'),
            '.',
            ' Winery Description: ',
            IFNULL(WINERY_DESCRIPTION, 'unknown'),
            '',
            ' The Primary Varietals this winery offers: ',
            IFNULL(PRIMARY_VARIETALS, 'unknown'),
            '.',
            ' Thoughts on the Tasting Room Experience: ',
            IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'),
            '.',
            ' Amenities: ',
            IFNULL(AMENITIES, 'unknown'),
            '.',
            ' Awards and Accolades: ',
            IFNULL(AWARDS_AND_ACCOLADES, 'unknown'),
            '.',
            ' Distance Travel Time considerations: ',
            IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'),
            '.',
            ' User Rating: ',
            IFNULL(USER_RATING, 'unknown'),
            '.',
            ' The Secondary Varietals for this winery: ',
            IFNULL(SECONDARY_VARIETALS, 'unknown'),
            '.',
            ' Wine Styles: ',
            IFNULL(WINE_STYLES, 'unknown'),
            '.',
            ' Events and Activities: ',
            IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'),
            '.',
            ' Sustainability Practices: ',
            IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'),
            '.',
            ' Social Media Channels: ',
            IFNULL(SOCIAL_MEDIA, 'unknown'),
            '',
            ' Address: ',
            IFNULL(ADDRESS, 'unknown'),
            '',
            ' City: ',
            IFNULL(CITY, 'unknown'),
            '',
            ' State: ',
            IFNULL(STATE, 'unknown'),
            '',
            ' ZIP: ',
            IFNULL(ZIP, 'unknown'),
            '',
            ' Phone: ',
            IFNULL(PHONE, 'unknown'),
            '',
            ' Winemaker: ',
            IFNULL(WINEMAKER, 'unknown'),
            '',
            ' Did Kelly Kohlleffel recommend this winery?: ',
            IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'),
            ''
        ) AS winery_information
    FROM
        `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
) as stg
SELECT
    *
FROM
    ML.GENERATE_TEXT_EMBEDDING(
        MODEL `project_beyondsql_genai_textembedding.llm_embedding_model`,
        (
            select
                winery_information as content
            from
                iamtests -315719.ragdemo.single_string_winery_review_vector
        ),
        STRUCT(TRUE AS flatten_json_output)
    );


[0m14:39:33.510911 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [89:3]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword AS at [89:3]')
[0m14:39:33.810096 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:0060128c-8943-46c0-a63f-2c480a25a544&page=queryresults
[0m14:39:33.811293 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:39:33.154260 => 14:39:33.810958
[0m14:39:33.825173 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Unexpected keyword AS at [89:3]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:39:33.825841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e60dcd81-1016-4350-9ffe-c461800fd2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89af65d270>]}
[0m14:39:33.826624 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 0.68s]
[0m14:39:33.827289 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:39:33.829527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:33.829933 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:39:33.830322 [info ] [MainThread]: 
[0m14:39:33.830803 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m14:39:33.831490 [debug] [MainThread]: Command end result
[0m14:39:33.840586 [info ] [MainThread]: 
[0m14:39:33.841180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:39:33.841643 [info ] [MainThread]: 
[0m14:39:33.842096 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m14:39:33.842543 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [89:3]
[0m14:39:33.842979 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:39:33.843497 [info ] [MainThread]: 
[0m14:39:33.844043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:39:33.845048 [debug] [MainThread]: Command `dbt run` failed at 14:39:33.844843 after 5.03 seconds
[0m14:39:33.845667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89af2d49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b498d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b4e711e0>]}
[0m14:39:33.846272 [debug] [MainThread]: Flushing usage events
[0m14:40:55.538715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb582c709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb583ffd570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb583ffe950>]}


============================== 14:40:55.544619 | eba20761-8483-414d-9db5-de0440a37a06 ==============================
[0m14:40:55.544619 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:40:55.545356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:40:57.162677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eba20761-8483-414d-9db5-de0440a37a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb583ffead0>]}
[0m14:40:57.181895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eba20761-8483-414d-9db5-de0440a37a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb587a3c730>]}
[0m14:40:57.182892 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:40:57.215380 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:40:57.270751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:57.271325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:57.279718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eba20761-8483-414d-9db5-de0440a37a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb587da9a80>]}
[0m14:40:57.290638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eba20761-8483-414d-9db5-de0440a37a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb587d7d7b0>]}
[0m14:40:57.291292 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:40:57.292226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eba20761-8483-414d-9db5-de0440a37a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb587d7d720>]}
[0m14:40:57.294734 [info ] [MainThread]: 
[0m14:40:57.296647 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:40:57.299548 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:40:57.300589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:58.628416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:40:58.629351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:58.904462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eba20761-8483-414d-9db5-de0440a37a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb583fff9d0>]}
[0m14:40:58.905700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:58.906247 [info ] [MainThread]: 
[0m14:40:58.911327 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:40:58.912109 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:40:58.913183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:40:58.913681 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:40:58.917028 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:40:58.918202 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:40:58.914014 => 14:40:58.917797
[0m14:40:58.918712 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:40:58.963437 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:40:58.964756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:58.965461 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as with st as  (
    SELECT
        CONCAT(
            'This winery name is ',
            IFNULL(WINERY_OR_VINEYARD, ' Name is not known'),
            '. California wine region: ',
            IFNULL(CA_WINE_REGION, 'unknown'),
            '',
            ' The AVA Appellation is the ',
            IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'),
            '.',
            ' The website associated with the winery is ',
            IFNULL(WEBSITE, 'unknown'),
            '.',
            ' Price Range: ',
            IFNULL(PRICE_RANGE, 'unknown'),
            '.',
            ' Tasting Room Hours: ',
            IFNULL(TASTING_ROOM_HOURS, 'unknown'),
            '.',
            ' Are Reservations Required or Not: ',
            IFNULL(RESERVATION_REQUIRED, 'unknown'),
            '.',
            ' Winery Description: ',
            IFNULL(WINERY_DESCRIPTION, 'unknown'),
            '',
            ' The Primary Varietals this winery offers: ',
            IFNULL(PRIMARY_VARIETALS, 'unknown'),
            '.',
            ' Thoughts on the Tasting Room Experience: ',
            IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'),
            '.',
            ' Amenities: ',
            IFNULL(AMENITIES, 'unknown'),
            '.',
            ' Awards and Accolades: ',
            IFNULL(AWARDS_AND_ACCOLADES, 'unknown'),
            '.',
            ' Distance Travel Time considerations: ',
            IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'),
            '.',
            ' User Rating: ',
            IFNULL(USER_RATING, 'unknown'),
            '.',
            ' The Secondary Varietals for this winery: ',
            IFNULL(SECONDARY_VARIETALS, 'unknown'),
            '.',
            ' Wine Styles: ',
            IFNULL(WINE_STYLES, 'unknown'),
            '.',
            ' Events and Activities: ',
            IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'),
            '.',
            ' Sustainability Practices: ',
            IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'),
            '.',
            ' Social Media Channels: ',
            IFNULL(SOCIAL_MEDIA, 'unknown'),
            '',
            ' Address: ',
            IFNULL(ADDRESS, 'unknown'),
            '',
            ' City: ',
            IFNULL(CITY, 'unknown'),
            '',
            ' State: ',
            IFNULL(STATE, 'unknown'),
            '',
            ' ZIP: ',
            IFNULL(ZIP, 'unknown'),
            '',
            ' Phone: ',
            IFNULL(PHONE, 'unknown'),
            '',
            ' Winemaker: ',
            IFNULL(WINEMAKER, 'unknown'),
            '',
            ' Did Kelly Kohlleffel recommend this winery?: ',
            IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'),
            ''
        ) AS winery_information
    FROM
        `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
) as stg
SELECT
    *
FROM
    ML.GENERATE_TEXT_EMBEDDING(
        MODEL `project_beyondsql_genai_textembedding.llm_embedding_model`,
        (
            select
                winery_information as content
            from
                iamtests -315719.ragdemo.single_string_winery_review_vector
        ),
        STRUCT(TRUE AS flatten_json_output)
    );


[0m14:40:59.269598 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [89:3]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword AS at [89:3]')
[0m14:41:00.118901 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:94ccf79f-5266-4aba-889a-285f347cc6e5&page=queryresults
[0m14:41:00.120014 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:40:58.919030 => 14:41:00.119665
[0m14:41:00.125565 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Unexpected keyword AS at [89:3]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:41:00.126218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba20761-8483-414d-9db5-de0440a37a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb587da8ac0>]}
[0m14:41:00.127075 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 1.21s]
[0m14:41:00.127768 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:41:00.130025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:00.130432 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:41:00.130832 [info ] [MainThread]: 
[0m14:41:00.131330 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m14:41:00.132055 [debug] [MainThread]: Command end result
[0m14:41:00.144101 [info ] [MainThread]: 
[0m14:41:00.145018 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:41:00.145639 [info ] [MainThread]: 
[0m14:41:00.146291 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m14:41:00.146993 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [89:3]
[0m14:41:00.147629 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:41:00.148128 [info ] [MainThread]: 
[0m14:41:00.148651 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:41:00.149797 [debug] [MainThread]: Command `dbt run` failed at 14:41:00.149614 after 4.65 seconds
[0m14:41:00.150390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb582c709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb587d966b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb587d96e90>]}
[0m14:41:00.151048 [debug] [MainThread]: Flushing usage events
[0m14:41:36.414484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cb649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0eff52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0eff6830>]}


============================== 14:41:36.419549 | d91eef3c-6049-4559-9c2c-5984207d16b5 ==============================
[0m14:41:36.419549 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:41:36.420295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:41:38.555373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd91eef3c-6049-4559-9c2c-5984207d16b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0eff69b0>]}
[0m14:41:38.575574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd91eef3c-6049-4559-9c2c-5984207d16b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb133e0670>]}
[0m14:41:38.577182 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:41:38.610696 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:41:38.693987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:38.694538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:38.704471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd91eef3c-6049-4559-9c2c-5984207d16b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb136899c0>]}
[0m14:41:38.714491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd91eef3c-6049-4559-9c2c-5984207d16b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb136616f0>]}
[0m14:41:38.715128 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:41:38.715639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91eef3c-6049-4559-9c2c-5984207d16b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb13661660>]}
[0m14:41:38.717487 [info ] [MainThread]: 
[0m14:41:38.718438 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:41:38.719731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:41:38.720268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:40.170319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:41:40.171234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:40.451245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91eef3c-6049-4559-9c2c-5984207d16b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0eff78b0>]}
[0m14:41:40.452591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:40.453223 [info ] [MainThread]: 
[0m14:41:40.460571 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:41:40.461324 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:41:40.462429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:41:40.463053 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:41:40.466733 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:41:40.468250 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:41:40.463420 => 14:41:40.467771
[0m14:41:40.469028 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:41:40.512295 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:41:40.513546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:40.514475 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as with st as  (
    SELECT
        CONCAT(
            'This winery name is ',
            IFNULL(WINERY_OR_VINEYARD, ' Name is not known'),
            '. California wine region: ',
            IFNULL(CA_WINE_REGION, 'unknown'),
            '',
            ' The AVA Appellation is the ',
            IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'),
            '.',
            ' The website associated with the winery is ',
            IFNULL(WEBSITE, 'unknown'),
            '.',
            ' Price Range: ',
            IFNULL(PRICE_RANGE, 'unknown'),
            '.',
            ' Tasting Room Hours: ',
            IFNULL(TASTING_ROOM_HOURS, 'unknown'),
            '.',
            ' Are Reservations Required or Not: ',
            IFNULL(RESERVATION_REQUIRED, 'unknown'),
            '.',
            ' Winery Description: ',
            IFNULL(WINERY_DESCRIPTION, 'unknown'),
            '',
            ' The Primary Varietals this winery offers: ',
            IFNULL(PRIMARY_VARIETALS, 'unknown'),
            '.',
            ' Thoughts on the Tasting Room Experience: ',
            IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'),
            '.',
            ' Amenities: ',
            IFNULL(AMENITIES, 'unknown'),
            '.',
            ' Awards and Accolades: ',
            IFNULL(AWARDS_AND_ACCOLADES, 'unknown'),
            '.',
            ' Distance Travel Time considerations: ',
            IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'),
            '.',
            ' User Rating: ',
            IFNULL(USER_RATING, 'unknown'),
            '.',
            ' The Secondary Varietals for this winery: ',
            IFNULL(SECONDARY_VARIETALS, 'unknown'),
            '.',
            ' Wine Styles: ',
            IFNULL(WINE_STYLES, 'unknown'),
            '.',
            ' Events and Activities: ',
            IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'),
            '.',
            ' Sustainability Practices: ',
            IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'),
            '.',
            ' Social Media Channels: ',
            IFNULL(SOCIAL_MEDIA, 'unknown'),
            '',
            ' Address: ',
            IFNULL(ADDRESS, 'unknown'),
            '',
            ' City: ',
            IFNULL(CITY, 'unknown'),
            '',
            ' State: ',
            IFNULL(STATE, 'unknown'),
            '',
            ' ZIP: ',
            IFNULL(ZIP, 'unknown'),
            '',
            ' Phone: ',
            IFNULL(PHONE, 'unknown'),
            '',
            ' Winemaker: ',
            IFNULL(WINEMAKER, 'unknown'),
            '',
            ' Did Kelly Kohlleffel recommend this winery?: ',
            IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'),
            ''
        ) AS winery_information
    FROM
        `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
) as stg
SELECT
    *
FROM
    ML.GENERATE_TEXT_EMBEDDING(
        MODEL `project_beyondsql_genai_textembedding.llm_embedding_model`,
        (
            select
                winery_information as content
            from
                iamtests -315719.ragdemo.single_string_winery_review_vector
        ),
        STRUCT(TRUE AS flatten_json_output)
    );


[0m14:41:40.818957 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [89:3]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword AS at [89:3]')
[0m14:41:41.601905 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:e0cad934-9fb3-435a-9a57-93c3b2518eba&page=queryresults
[0m14:41:41.603106 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:41:40.469391 => 14:41:41.602736
[0m14:41:41.618061 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Unexpected keyword AS at [89:3]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:41:41.618829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91eef3c-6049-4559-9c2c-5984207d16b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb13688c10>]}
[0m14:41:41.619657 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 1.16s]
[0m14:41:41.620501 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:41:41.622847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:41.623325 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:41:41.623829 [info ] [MainThread]: 
[0m14:41:41.624333 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m14:41:41.625169 [debug] [MainThread]: Command end result
[0m14:41:41.635726 [info ] [MainThread]: 
[0m14:41:41.636341 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:41:41.636798 [info ] [MainThread]: 
[0m14:41:41.637321 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m14:41:41.637873 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [89:3]
[0m14:41:41.638329 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:41:41.638851 [info ] [MainThread]: 
[0m14:41:41.639397 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:41:41.640482 [debug] [MainThread]: Command `dbt run` failed at 14:41:41.640276 after 5.26 seconds
[0m14:41:41.641051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cb649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb08f4dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb137269e0>]}
[0m14:41:41.641546 [debug] [MainThread]: Flushing usage events
[0m14:42:28.208802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f72ad49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f73ffbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f73ffa950>]}


============================== 14:42:28.215998 | 4d0f2d81-dc29-48bf-832b-6d9d33def860 ==============================
[0m14:42:28.215998 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:42:28.217269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:42:31.427494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d0f2d81-dc29-48bf-832b-6d9d33def860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f73ffaad0>]}
[0m14:42:31.449528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d0f2d81-dc29-48bf-832b-6d9d33def860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f781e4730>]}
[0m14:42:31.450905 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:42:31.484722 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:42:31.562344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:31.563196 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m14:42:31.593988 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:42:31.626700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d0f2d81-dc29-48bf-832b-6d9d33def860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f785edfc0>]}
[0m14:42:31.635768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d0f2d81-dc29-48bf-832b-6d9d33def860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f78565780>]}
[0m14:42:31.636402 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:42:31.636919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d0f2d81-dc29-48bf-832b-6d9d33def860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f785656c0>]}
[0m14:42:31.638726 [info ] [MainThread]: 
[0m14:42:31.640446 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:42:31.641984 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:42:31.642554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:33.399364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:42:33.400166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:33.678617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d0f2d81-dc29-48bf-832b-6d9d33def860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f78590940>]}
[0m14:42:33.679951 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:33.680671 [info ] [MainThread]: 
[0m14:42:33.803878 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:42:33.805042 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:42:33.806273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:42:33.806905 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:42:33.810318 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:42:33.811964 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:42:33.807315 => 14:42:33.811524
[0m14:42:33.812655 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:42:33.861468 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:42:33.862752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:33.863522 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as with st as  (
    SELECT
        CONCAT(
            'This winery name is ',
            IFNULL(WINERY_OR_VINEYARD, ' Name is not known'),
            '. California wine region: ',
            IFNULL(CA_WINE_REGION, 'unknown'),
            '',
            ' The AVA Appellation is the ',
            IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'),
            '.',
            ' The website associated with the winery is ',
            IFNULL(WEBSITE, 'unknown'),
            '.',
            ' Price Range: ',
            IFNULL(PRICE_RANGE, 'unknown'),
            '.',
            ' Tasting Room Hours: ',
            IFNULL(TASTING_ROOM_HOURS, 'unknown'),
            '.',
            ' Are Reservations Required or Not: ',
            IFNULL(RESERVATION_REQUIRED, 'unknown'),
            '.',
            ' Winery Description: ',
            IFNULL(WINERY_DESCRIPTION, 'unknown'),
            '',
            ' The Primary Varietals this winery offers: ',
            IFNULL(PRIMARY_VARIETALS, 'unknown'),
            '.',
            ' Thoughts on the Tasting Room Experience: ',
            IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'),
            '.',
            ' Amenities: ',
            IFNULL(AMENITIES, 'unknown'),
            '.',
            ' Awards and Accolades: ',
            IFNULL(AWARDS_AND_ACCOLADES, 'unknown'),
            '.',
            ' Distance Travel Time considerations: ',
            IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'),
            '.',
            ' User Rating: ',
            IFNULL(USER_RATING, 'unknown'),
            '.',
            ' The Secondary Varietals for this winery: ',
            IFNULL(SECONDARY_VARIETALS, 'unknown'),
            '.',
            ' Wine Styles: ',
            IFNULL(WINE_STYLES, 'unknown'),
            '.',
            ' Events and Activities: ',
            IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'),
            '.',
            ' Sustainability Practices: ',
            IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'),
            '.',
            ' Social Media Channels: ',
            IFNULL(SOCIAL_MEDIA, 'unknown'),
            '',
            ' Address: ',
            IFNULL(ADDRESS, 'unknown'),
            '',
            ' City: ',
            IFNULL(CITY, 'unknown'),
            '',
            ' State: ',
            IFNULL(STATE, 'unknown'),
            '',
            ' ZIP: ',
            IFNULL(ZIP, 'unknown'),
            '',
            ' Phone: ',
            IFNULL(PHONE, 'unknown'),
            '',
            ' Winemaker: ',
            IFNULL(WINEMAKER, 'unknown'),
            '',
            ' Did Kelly Kohlleffel recommend this winery?: ',
            IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'),
            ''
        ) AS winery_information
    FROM
        `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
) as stg
SELECT
    *
FROM
    ML.GENERATE_TEXT_EMBEDDING(
        MODEL `project_beyondsql_genai_textembedding.llm_embedding_model`,
        (
            select
                winery_information as content
            from
                stg
        ),
        STRUCT(TRUE AS flatten_json_output)
    );


[0m14:42:34.152681 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [89:3]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword AS at [89:3]')
[0m14:42:34.654476 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:277a779f-c0f0-47c1-8541-6e10b18fbf02&page=queryresults
[0m14:42:34.656027 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:42:33.813084 => 14:42:34.655610
[0m14:42:34.670578 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Syntax error: Unexpected keyword AS at [89:3]
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:42:34.671252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0f2d81-dc29-48bf-832b-6d9d33def860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6c3955a0>]}
[0m14:42:34.672040 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 0.87s]
[0m14:42:34.672739 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:42:34.674855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:34.675263 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:42:34.675667 [info ] [MainThread]: 
[0m14:42:34.676147 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m14:42:34.676863 [debug] [MainThread]: Command end result
[0m14:42:34.685512 [info ] [MainThread]: 
[0m14:42:34.686087 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:34.686523 [info ] [MainThread]: 
[0m14:42:34.686956 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m14:42:34.687382 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [89:3]
[0m14:42:34.687801 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:42:34.688218 [info ] [MainThread]: 
[0m14:42:34.688827 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:34.690532 [debug] [MainThread]: Command `dbt run` failed at 14:42:34.690342 after 6.53 seconds
[0m14:42:34.691073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f72ad49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7811d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6c35edd0>]}
[0m14:42:34.691575 [debug] [MainThread]: Flushing usage events
[0m14:43:14.294298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8adab589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8adbfe9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8adbfe8370>]}


============================== 14:43:14.301266 | f4572fad-a0fa-495c-b73e-85a105179606 ==============================
[0m14:43:14.301266 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:43:14.302076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:43:16.691429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4572fad-a0fa-495c-b73e-85a105179606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8adbfea9e0>]}
[0m14:43:16.709638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4572fad-a0fa-495c-b73e-85a105179606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae03e46d0>]}
[0m14:43:16.711223 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:43:16.743498 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:43:16.815876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:16.816619 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m14:43:16.850520 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:43:16.877661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4572fad-a0fa-495c-b73e-85a105179606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae05edf90>]}
[0m14:43:16.886711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4572fad-a0fa-495c-b73e-85a105179606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae0561750>]}
[0m14:43:16.887417 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:43:16.887940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4572fad-a0fa-495c-b73e-85a105179606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae0561690>]}
[0m14:43:16.889697 [info ] [MainThread]: 
[0m14:43:16.890620 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:43:16.891874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:43:16.892422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:18.410533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:43:18.411383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:18.756373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4572fad-a0fa-495c-b73e-85a105179606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae0590910>]}
[0m14:43:18.760343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:18.761507 [info ] [MainThread]: 
[0m14:43:18.933846 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:18.934982 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:43:18.936137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:43:18.936780 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:18.939801 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:43:18.941271 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:43:18.937179 => 14:43:18.940879
[0m14:43:18.941849 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:18.996747 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:43:18.997939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:18.998829 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as with st as  (
    SELECT
        CONCAT(
            'This winery name is ',
            IFNULL(WINERY_OR_VINEYARD, ' Name is not known'),
            '. California wine region: ',
            IFNULL(CA_WINE_REGION, 'unknown'),
            '',
            ' The AVA Appellation is the ',
            IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'),
            '.',
            ' The website associated with the winery is ',
            IFNULL(WEBSITE, 'unknown'),
            '.',
            ' Price Range: ',
            IFNULL(PRICE_RANGE, 'unknown'),
            '.',
            ' Tasting Room Hours: ',
            IFNULL(TASTING_ROOM_HOURS, 'unknown'),
            '.',
            ' Are Reservations Required or Not: ',
            IFNULL(RESERVATION_REQUIRED, 'unknown'),
            '.',
            ' Winery Description: ',
            IFNULL(WINERY_DESCRIPTION, 'unknown'),
            '',
            ' The Primary Varietals this winery offers: ',
            IFNULL(PRIMARY_VARIETALS, 'unknown'),
            '.',
            ' Thoughts on the Tasting Room Experience: ',
            IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'),
            '.',
            ' Amenities: ',
            IFNULL(AMENITIES, 'unknown'),
            '.',
            ' Awards and Accolades: ',
            IFNULL(AWARDS_AND_ACCOLADES, 'unknown'),
            '.',
            ' Distance Travel Time considerations: ',
            IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'),
            '.',
            ' User Rating: ',
            IFNULL(USER_RATING, 'unknown'),
            '.',
            ' The Secondary Varietals for this winery: ',
            IFNULL(SECONDARY_VARIETALS, 'unknown'),
            '.',
            ' Wine Styles: ',
            IFNULL(WINE_STYLES, 'unknown'),
            '.',
            ' Events and Activities: ',
            IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'),
            '.',
            ' Sustainability Practices: ',
            IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'),
            '.',
            ' Social Media Channels: ',
            IFNULL(SOCIAL_MEDIA, 'unknown'),
            '',
            ' Address: ',
            IFNULL(ADDRESS, 'unknown'),
            '',
            ' City: ',
            IFNULL(CITY, 'unknown'),
            '',
            ' State: ',
            IFNULL(STATE, 'unknown'),
            '',
            ' ZIP: ',
            IFNULL(ZIP, 'unknown'),
            '',
            ' Phone: ',
            IFNULL(PHONE, 'unknown'),
            '',
            ' Winemaker: ',
            IFNULL(WINEMAKER, 'unknown'),
            '',
            ' Did Kelly Kohlleffel recommend this winery?: ',
            IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'),
            ''
        ) AS winery_information
    FROM
        `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
) 
SELECT
    *
FROM
    ML.GENERATE_TEXT_EMBEDDING(
        MODEL `project_beyondsql_genai_textembedding.llm_embedding_model`,
        (
            select
                winery_information as content
            from
                stg
        ),
        STRUCT(TRUE AS flatten_json_output)
    );


[0m14:43:19.285001 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg, message: Table "stg" must be qualified with a dataset (e.g. dataset.table).')
[0m14:43:20.474810 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:912ab0d7-7166-453d-967e-6737317071ea&page=queryresults
[0m14:43:20.475833 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:43:18.942189 => 14:43:20.475514
[0m14:43:20.489005 [debug] [Thread-1 (]: Database Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)
  Table "stg" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:43:20.489685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4572fad-a0fa-495c-b73e-85a105179606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8adad42950>]}
[0m14:43:20.490501 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[31mERROR[0m in 1.55s]
[0m14:43:20.491196 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:20.493224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:20.493601 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:43:20.494004 [info ] [MainThread]: 
[0m14:43:20.494477 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m14:43:20.495171 [debug] [MainThread]: Command end result
[0m14:43:20.504106 [info ] [MainThread]: 
[0m14:43:20.504762 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:43:20.505219 [info ] [MainThread]: 
[0m14:43:20.505679 [error] [MainThread]: [33mDatabase Error in model single_string_winery_review_vector (models/single_string_winery_review_vector.sql)[0m
[0m14:43:20.506147 [error] [MainThread]:   Table "stg" must be qualified with a dataset (e.g. dataset.table).
[0m14:43:20.506587 [error] [MainThread]:   compiled Code at target/run/rag_pre_transform/models/single_string_winery_review_vector.sql
[0m14:43:20.507028 [info ] [MainThread]: 
[0m14:43:20.507506 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:43:20.508498 [debug] [MainThread]: Command `dbt run` failed at 14:43:20.508337 after 6.25 seconds
[0m14:43:20.509000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8adab589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae031d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad585edd0>]}
[0m14:43:20.509580 [debug] [MainThread]: Flushing usage events
[0m14:43:49.870116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1e9b49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1ff155a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1ff14310>]}


============================== 14:43:49.875143 | d681e7cd-4b9f-49d7-b491-7a6ee9ac4575 ==============================
[0m14:43:49.875143 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:43:49.875986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/wazi/Downloads/fivetran_demo_rag/logs', 'debug': 'False', 'profiles_dir': '/Users/wazi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:43:51.670639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd681e7cd-4b9f-49d7-b491-7a6ee9ac4575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1ff16800>]}
[0m14:43:51.690815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd681e7cd-4b9f-49d7-b491-7a6ee9ac4575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23a1c6d0>]}
[0m14:43:51.691773 [info ] [MainThread]: Registered adapter: bigquery=1.5.9
[0m14:43:51.724721 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:43:51.784946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:51.785695 [debug] [MainThread]: Partial parsing: updated file: rag_pre_transform://models/single_string_winery_review_vector.sql
[0m14:43:51.818255 [debug] [MainThread]: 1699: static parser successfully parsed single_string_winery_review_vector.sql
[0m14:43:51.845951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd681e7cd-4b9f-49d7-b491-7a6ee9ac4575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23e31f60>]}
[0m14:43:51.854969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd681e7cd-4b9f-49d7-b491-7a6ee9ac4575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23d89720>]}
[0m14:43:51.855595 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 358 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:43:51.856092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd681e7cd-4b9f-49d7-b491-7a6ee9ac4575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23d89660>]}
[0m14:43:51.857955 [info ] [MainThread]: 
[0m14:43:51.858976 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:43:51.860397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_iamtests-315719'
[0m14:43:51.861096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:53.265563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iamtests-315719, now list_iamtests-315719_fivetran_demo_rag_agriculture)
[0m14:43:53.266595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:53.594752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd681e7cd-4b9f-49d7-b491-7a6ee9ac4575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23db88e0>]}
[0m14:43:53.597103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:53.599620 [info ] [MainThread]: 
[0m14:43:53.771547 [debug] [Thread-1 (]: Began running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:53.773665 [info ] [Thread-1 (]: 1 of 1 START sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [RUN]
[0m14:43:53.775141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iamtests-315719_fivetran_demo_rag_agriculture, now model.rag_pre_transform.single_string_winery_review_vector)
[0m14:43:53.777561 [debug] [Thread-1 (]: Began compiling node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:53.781507 [debug] [Thread-1 (]: Writing injected SQL for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:43:53.782803 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (compile): 14:43:53.778513 => 14:43:53.782440
[0m14:43:53.783321 [debug] [Thread-1 (]: Began executing node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:53.844374 [debug] [Thread-1 (]: Writing runtime sql for node "model.rag_pre_transform.single_string_winery_review_vector"
[0m14:43:53.845857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:53.847140 [debug] [Thread-1 (]: On model.rag_pre_transform.single_string_winery_review_vector: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "rag_pre_transform", "target_name": "dev", "node_id": "model.rag_pre_transform.single_string_winery_review_vector"} */


  create or replace view `iamtests-315719`.`fivetran_demo_rag_agriculture`.`single_string_winery_review_vector`
  OPTIONS()
  as with stg as  (
    SELECT
        CONCAT(
            'This winery name is ',
            IFNULL(WINERY_OR_VINEYARD, ' Name is not known'),
            '. California wine region: ',
            IFNULL(CA_WINE_REGION, 'unknown'),
            '',
            ' The AVA Appellation is the ',
            IFNULL(AVA_APPELLATION_SUB_APPELLATION, 'unknown'),
            '.',
            ' The website associated with the winery is ',
            IFNULL(WEBSITE, 'unknown'),
            '.',
            ' Price Range: ',
            IFNULL(PRICE_RANGE, 'unknown'),
            '.',
            ' Tasting Room Hours: ',
            IFNULL(TASTING_ROOM_HOURS, 'unknown'),
            '.',
            ' Are Reservations Required or Not: ',
            IFNULL(RESERVATION_REQUIRED, 'unknown'),
            '.',
            ' Winery Description: ',
            IFNULL(WINERY_DESCRIPTION, 'unknown'),
            '',
            ' The Primary Varietals this winery offers: ',
            IFNULL(PRIMARY_VARIETALS, 'unknown'),
            '.',
            ' Thoughts on the Tasting Room Experience: ',
            IFNULL(TASTING_ROOM_EXPERIENCE, 'unknown'),
            '.',
            ' Amenities: ',
            IFNULL(AMENITIES, 'unknown'),
            '.',
            ' Awards and Accolades: ',
            IFNULL(AWARDS_AND_ACCOLADES, 'unknown'),
            '.',
            ' Distance Travel Time considerations: ',
            IFNULL(DISTANCE_AND_TRAVEL_TIME, 'unknown'),
            '.',
            ' User Rating: ',
            IFNULL(USER_RATING, 'unknown'),
            '.',
            ' The Secondary Varietals for this winery: ',
            IFNULL(SECONDARY_VARIETALS, 'unknown'),
            '.',
            ' Wine Styles: ',
            IFNULL(WINE_STYLES, 'unknown'),
            '.',
            ' Events and Activities: ',
            IFNULL(EVENTS_AND_ACTIVITIES, 'unknown'),
            '.',
            ' Sustainability Practices: ',
            IFNULL(SUSTAINABILITY_PRACTICES, 'unknown'),
            '.',
            ' Social Media Channels: ',
            IFNULL(SOCIAL_MEDIA, 'unknown'),
            '',
            ' Address: ',
            IFNULL(ADDRESS, 'unknown'),
            '',
            ' City: ',
            IFNULL(CITY, 'unknown'),
            '',
            ' State: ',
            IFNULL(STATE, 'unknown'),
            '',
            ' ZIP: ',
            IFNULL(ZIP, 'unknown'),
            '',
            ' Phone: ',
            IFNULL(PHONE, 'unknown'),
            '',
            ' Winemaker: ',
            IFNULL(WINEMAKER, 'unknown'),
            '',
            ' Did Kelly Kohlleffel recommend this winery?: ',
            IFNULL(KELLY_KOHLLEFFEL_RECOMMENDED, 'unknown'),
            ''
        ) AS winery_information
    FROM
        `iamtests-315719.fivetran_demo_rag_agriculture.california_wine_country_visits`
) 
SELECT
    *
FROM
    ML.GENERATE_TEXT_EMBEDDING(
        MODEL `project_beyondsql_genai_textembedding.llm_embedding_model`,
        (
            select
                winery_information as content
            from
                stg
        ),
        STRUCT(TRUE AS flatten_json_output)
    );


[0m14:43:54.991030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=iamtests-315719&j=bq:US:55b3248d-537f-4f9e-8d91-544fb0ba5c20&page=queryresults
[0m14:43:55.011365 [debug] [Thread-1 (]: Timing info for model.rag_pre_transform.single_string_winery_review_vector (execute): 14:43:53.783744 => 14:43:55.010965
[0m14:43:55.012621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd681e7cd-4b9f-49d7-b491-7a6ee9ac4575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1ff03a00>]}
[0m14:43:55.013777 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fivetran_demo_rag_agriculture.single_string_winery_review_vector  [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m14:43:55.014914 [debug] [Thread-1 (]: Finished running node model.rag_pre_transform.single_string_winery_review_vector
[0m14:43:55.017119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:55.017606 [debug] [MainThread]: Connection 'model.rag_pre_transform.single_string_winery_review_vector' was properly closed.
[0m14:43:55.018143 [info ] [MainThread]: 
[0m14:43:55.018674 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m14:43:55.019766 [debug] [MainThread]: Command end result
[0m14:43:55.029299 [info ] [MainThread]: 
[0m14:43:55.030041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:55.030629 [info ] [MainThread]: 
[0m14:43:55.031274 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:43:55.032258 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:55.032075 after 5.19 seconds
[0m14:43:55.032803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1e9b49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1ece7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd238bfdf0>]}
[0m14:43:55.033396 [debug] [MainThread]: Flushing usage events
